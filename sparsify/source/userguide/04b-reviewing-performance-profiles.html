<!DOCTYPE html>
<html class="writer-html5" lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Reviewing Performance Profiles — Sparsify 0.2.0 documentation
  </title>
  <link href="../../_static/css/theme.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/copybutton.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/css/nm-theme-adjustment.css" rel="stylesheet" type="text/css"/>
  <link href="../../_static/favicon.ico" rel="shortcut icon"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js" type="text/javascript">
  </script>
  <script src="../../_static/jquery.js">
  </script>
  <script src="../../_static/underscore.js">
  </script>
  <script src="../../_static/doctools.js">
  </script>
  <script src="../../_static/clipboard.min.js">
  </script>
  <script src="../../_static/copybutton.js">
  </script>
  <script src="../../_static/js/theme.js" type="text/javascript">
  </script>
  <link href="../../genindex.html" rel="index" title="Index"/>
  <link href="../../search.html" rel="search" title="Search"/>
  <link href="04c-reviewing-loss-profiles.html" rel="next" title="Reviewing Loss Profiles"/>
  <link href="04-analyze.html" rel="prev" title="Analyze"/>
 </head>
 <body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
   <nav class="wy-nav-side" data-toggle="wy-nav-shift">
    <div class="wy-side-scroll">
     <div class="wy-side-nav-search">
      <a class="icon icon-home" href="../../index.html">
       Sparsify
       <img alt="Logo" class="logo" src="../../_static/icon-sparsify.png"/>
      </a>
      <div class="version">
       0.2
      </div>
      <div role="search">
       <form action="../../search.html" class="wy-form" id="rtd-search-form" method="get">
        <input name="q" placeholder="Search docs" type="text"/>
        <input name="check_keywords" type="hidden" value="yes"/>
        <input name="area" type="hidden" value="default"/>
       </form>
      </div>
     </div>
     <div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
      <p class="caption">
       <span class="caption-text">
        General
       </span>
      </p>
      <ul class="current">
       <li class="toctree-l1">
        <a class="reference internal" href="../quicktour.html">
         Quick Tour
        </a>
       </li>
       <li class="toctree-l1">
        <a class="reference internal" href="../installation.html">
         Installation
        </a>
       </li>
       <li class="toctree-l1 current">
        <a class="reference internal" href="index.html">
         User Guide
        </a>
        <ul class="current">
         <li class="toctree-l2">
          <a class="reference internal" href="01-intro.html">
           Welcome to Sparsify
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="02-install-sparsify.html">
           Installing and Launching Sparsify
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="03-sparsify-overview.html">
           Sparsify Overview
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="04-analyze.html">
           Analyze
          </a>
         </li>
         <li class="toctree-l2 current">
          <a class="current reference internal" href="#">
           Reviewing Performance Profiles
          </a>
          <ul>
           <li class="toctree-l3">
            <a class="reference internal" href="#model-summary">
             Model Summary
            </a>
           </li>
           <li class="toctree-l3">
            <a class="reference internal" href="#layer-summaries">
             Layer Summaries
            </a>
           </li>
           <li class="toctree-l3">
            <a class="reference internal" href="#layer-results">
             Layer Results
            </a>
           </li>
           <li class="toctree-l3">
            <a class="reference internal" href="#adding-a-new-performance-profile">
             Adding a New Performance Profile
            </a>
           </li>
          </ul>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="04c-reviewing-loss-profiles.html">
           Reviewing Loss Profiles
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="05-optimize.html">
           Optimize
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="05a-benchmark.html">
           Benchmarking
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="06-integrate.html">
           Integrate
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="06a-optimize-config.html">
           Optimization Config File and Code for Optimization
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="07-settings.html">
           Settings
          </a>
         </li>
         <li class="toctree-l2">
          <a class="reference internal" href="08-key-terms.html">
           Key Concepts/Features/Terms
          </a>
         </li>
        </ul>
       </li>
      </ul>
      <p class="caption">
       <span class="caption-text">
        API
       </span>
      </p>
      <ul>
       <li class="toctree-l1">
        <a class="reference internal" href="../../api/sparsify.html">
         sparsify package
        </a>
       </li>
      </ul>
      <p class="caption">
       <span class="caption-text">
        Help
       </span>
      </p>
      <ul>
       <li class="toctree-l1">
        <a class="reference external" href="https://github.com/neuralmagic/sparsify/issues">
         Bugs, Feature Requests
        </a>
       </li>
       <li class="toctree-l1">
        <a class="reference external" href="https://github.com/neuralmagic/sparsify/discussions">
         Support, General Q&amp;A
        </a>
       </li>
       <li class="toctree-l1">
        <a class="reference external" href="https://docs.neuralmagic.com">
         Neural Magic Docs
        </a>
       </li>
      </ul>
     </div>
    </div>
   </nav>
   <section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
    <nav aria-label="top navigation" class="wy-nav-top">
     <i class="fa fa-bars" data-toggle="wy-nav-top">
     </i>
     <a href="../../index.html">
      Sparsify
     </a>
    </nav>
    <div class="wy-nav-content">
     <div class="rst-content">
      <div aria-label="breadcrumbs navigation" role="navigation">
       <ul class="wy-breadcrumbs">
        <li>
         <a class="icon icon-home" href="../../index.html">
         </a>
         »
        </li>
        <li>
         <a href="index.html">
          User Guide
         </a>
         »
        </li>
        <li>
         Reviewing Performance Profiles
        </li>
        <li class="wy-breadcrumbs-aside">
         <a href="../../_sources/source/userguide/04b-reviewing-performance-profiles.md.txt" rel="nofollow">
          View page source
         </a>
        </li>
       </ul>
       <hr/>
      </div>
      <div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
       <div itemprop="articleBody">
        <!--
Copyright (c) 2021 - present / Neuralmagic, Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
        <div class="section" id="reviewing-performance-profiles">
         <h1>
          Reviewing Performance Profiles
          <a class="headerlink" href="#reviewing-performance-profiles" title="Permalink to this headline">
           ¶
          </a>
         </h1>
         <p>
          The performance profile is tied to the batch size and core count. It is used to optimize, retrain, and utilize Neural Magic’s DeepSparse Engine to achieve faster inference timings.
         </p>
         <p>
          <kbd>
           <img alt="(Performance profile)" height="270" src="images/image_14.jpg" width="480"/>
          </kbd>
         </p>
         <p>
          You might see two types of performance profiles listed in the Performance Profiles section of the navigation bar:
         </p>
         <ul class="simple">
          <li>
           <p>
            “baseline” (the name entered on the New Project Setup dialog)—the profile that you defined, which includes measured values of how long it took to run your model as well as each layer in the model.
           </p>
          </li>
          <li>
           <p>
            FLOPS—a profile that is a theoretical measurement of performance based on the floating point operations per second profile. This graph always appears and indicates the compute-intensivity of your model. A larger model has more FLOPS, while a smaller model has fewer FLOPS. In general, a model with more FLOPS will take longer to run.
           </p>
          </li>
         </ul>
         <p>
          The Performance Profile consists of three sections:
         </p>
         <ul class="simple">
          <li>
           <p>
            Model Summary
           </p>
          </li>
          <li>
           <p>
            Layer Summaries
           </p>
          </li>
          <li>
           <p>
            Layer Results
           </p>
          </li>
         </ul>
         <div class="section" id="model-summary">
          <h2>
           Model Summary
           <a class="headerlink" href="#model-summary" title="Permalink to this headline">
            ¶
           </a>
          </h2>
          <p>
           The Model Summary provides information about the performance profile, including the batch size, core count, and instruction sets that were available when the profile was run.
          </p>
          <p>
           <kbd>
            <img alt="(Model summary)" height="150" src="images/image_15.jpg" width="500"/>
           </kbd>
          </p>
          <p>
           The Model Summary also shows how fast the model ran and how fast Sparsify estimates that it can run when optimized.
          </p>
          <p>
           <kbd>
            <img alt="(Model summary, measured speed detail)" height="55" src="images/image_15a.jpg" width="180"/>
           </kbd>
          </p>
          <p>
           Measured speed of the model when the profile was run indicates how fast the model runs currently through DeepSparse Engine. Timing information is displayed as milliseconds per batch and what that equates to as items per second.
          </p>
          <p>
           <kbd>
            <img alt="(Model summary, estimated speedup times)" height="80" src="images/image_15b.jpg" width="180"/>
           </kbd>
          </p>
          <p>
           Estimated speedup times (with limited effect on the loss) are indicated if model optimizations are applied. Timing information is displayed as estimated milliseconds per batch and the estimated performance speedup factor if the model is optimized.
          </p>
          <p>
           The next portion of the screen enables you to visualize where the timing for your model is going.
          </p>
         </div>
         <div class="section" id="layer-summaries">
          <h2>
           Layer Summaries
           <a class="headerlink" href="#layer-summaries" title="Permalink to this headline">
            ¶
           </a>
          </h2>
          <p>
           This graph shows where the majority of time is spent for different layer types.* This can help you determine if optimization will be helpful. It shows the potential speedup time or speedup percentage per layer type based on optimization.
          </p>
          <ul class="simple">
           <li>
            <p>
             The layer types (operators) will vary based on the model.
            </p>
           </li>
          </ul>
          <p>
           <strong>
            Note:
           </strong>
           The specific layer types depend on the model that is loaded.
          </p>
          <p>
           In the following example, most of the time is spent in convolution, and convolution is an area in which pruning can result in significant speedup. Conversely, if the graph showed that most of the time is spent in shuffle or other subgraphs, pruning would not help.
          </p>
          <p>
           <kbd>
            <img alt="(Layer summaries graph)" height="220" src="images/image_16.jpg" width="440"/>
           </kbd>
          </p>
          <p>
           ORT indicates times that were not run through the DeepSparse Engine and instead went through ONNX runtime. ORT items do not get speedup.
          </p>
          <p>
           The Summary Type is set as Baseline MS by default. This shows the results of running the model as fast as possible without optimization. Options are available to review the results based on measurements with different pruning values. For example, if you select Pruned 0.9 MS, the results are shown to represent 90% pruning (90% sparse, 10% dense) across the entire model.
          </p>
         </div>
         <div class="section" id="layer-results">
          <h2>
           Layer Results
           <a class="headerlink" href="#layer-results" title="Permalink to this headline">
            ¶
           </a>
          </h2>
          <p>
           This graph drills down deeper on a per node, per layer basis to see what was run and where time was spent on your model. You can look at the various optimizations that were run for profiling to determine which layer runs fastest and where there may be problems running the model. For example, if you see that two of the layers are each taking 20% of the time, you will want to either re-architect or extensively prune those layers to optimize the time.
          </p>
          <p>
           <kbd>
            <img alt="(Layer results graph)" height="270" src="images/image_17.jpg" width="440"/>
           </kbd>
          </p>
          <p>
           Layer ID is the ONNX ID for the layer.
          </p>
          <p>
           Weight name comes from the ONNX graph. It is held constant across ONNX and all the way back to the original framework (PyTorch or TensorFlow).
          </p>
         </div>
         <div class="section" id="adding-a-new-performance-profile">
          <h2>
           Adding a New Performance Profile
           <a class="headerlink" href="#adding-a-new-performance-profile" title="Permalink to this headline">
            ¶
           </a>
          </h2>
          <p>
           You can identify a new performance profile:
          </p>
          <ol>
           <li>
            <p>
             Click the
             <kbd>
              <img alt="(+ icon)" height="25" src="images/image_18.jpg" width="25"/>
             </kbd>
             icon in the Performance Profiles section of the navigation bar.
            </p>
           </li>
           <li>
            <p>
             Enter the profile name.
            </p>
           </li>
           <li>
            <p>
             You can change the batch size and/or CPU cores, which can affect the optimization and performance differently. Generally, larger batch sizes enable better efficiency in the engine for both sparse and dense models; therefore, throughput can be increased even more by increasing the batch size for most models.
            </p>
           </li>
           <li>
            <p>
             Click
             <strong>
              ADD
             </strong>
             .
            </p>
            <p>
             <kbd>
              <img alt="(New Performance Profile form)" height="250" src="images/image_19.jpg" width="340"/>
             </kbd>
            </p>
           </li>
          </ol>
          <hr class="docutils"/>
          <p>
           <strong>
            Next steps…
           </strong>
          </p>
          <p>
           Continue by reviewing your
           <a class="reference internal" href="04c-reviewing-loss-profiles.html">
            <span class="doc">
             Loss Profiles
            </span>
           </a>
           .
Then, you will be ready to
           <a class="reference internal" href="05-optimize.html">
            <span class="doc">
             Optimize
            </span>
           </a>
           .
          </p>
         </div>
        </div>
       </div>
      </div>
      <footer>
       <div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
        <a accesskey="n" class="btn btn-neutral float-right" href="04c-reviewing-loss-profiles.html" rel="next" title="Reviewing Loss Profiles">
         Next
         <span aria-hidden="true" class="fa fa-arrow-circle-right">
         </span>
        </a>
        <a accesskey="p" class="btn btn-neutral float-left" href="04-analyze.html" rel="prev" title="Analyze">
         <span aria-hidden="true" class="fa fa-arrow-circle-left">
         </span>
         Previous
        </a>
       </div>
       <hr/>
       <div role="contentinfo">
        <p>
         © Copyright 2021 - present / Neuralmagic, Inc. All Rights Reserved. Licensed under the Apache License, Version 2.0 (the "License").
        </p>
       </div>
       Built with
       <a href="https://www.sphinx-doc.org/">
        Sphinx
       </a>
       using a
       <a href="https://github.com/readthedocs/sphinx_rtd_theme">
        theme
       </a>
       provided by
       <a href="https://readthedocs.org">
        Read the Docs
       </a>
       .
      </footer>
     </div>
    </div>
   </section>
  </div>
  <div aria-label="versions" class="rst-versions" data-toggle="rst-versions" role="note">
   <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book">
     Other Versions
    </span>
    v: main
    <span class="fa fa-caret-down">
    </span>
   </span>
   <div class="rst-other-versions">
    <dl>
     <dt>
      Branches
     </dt>
     <dd>
      <a href="04b-reviewing-performance-profiles.html">
       main
      </a>
     </dd>
    </dl>
   </div>
  </div>
  <script type="text/javascript">
   jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
  <!-- Theme Analytics -->
  <script>
   (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-128364174-1', 'auto');
    
    ga('send', 'pageview');
  </script>
 </body>
</html>