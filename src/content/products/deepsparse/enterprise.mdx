---
title: "DeepSparse Enterprise"
metaTitle: "DeepSparse Enterprise"
metaDescription: "Sparsity-aware neural network inference engine for GPU-class performance on CPUs"
index: 2000
---

<div style="display: flex; flex-direction: column;">
  <h1>
    <img alt="tool icon" src="https://raw.githubusercontent.com/neuralmagic/deepsparse/main/docs/source/icon-deepsparse.png" />
    &nbsp;&nbsp;DeepSparse Enterprise
  </h1>
  <h3> Sparsity-aware neural network inference engine for GPU-class performance on CPUs </h3>
  <div style="display: flex; flex-wrap: wrap">
    <a href="https://docs.neuralmagic.com/products/deepsparse/">
      <img alt="Documentation" src="https://img.shields.io/badge/documentation-darkred?&style=for-the-badge&logo=read-the-docs" height="25" />
    </a>
    <a href="https://join.slack.com/t/discuss-neuralmagic/shared_invite/zt-q1a1cnvo-YBoICSIw3L1dmQpjBeDurQ/">
      <img alt="Slack" src="https://img.shields.io/badge/slack-purple?style=for-the-badge&logo=slack" height="25" />
    </a>
    <a href="https://github.com/neuralmagic/deepsparse/issues/">
      <img alt="Support" src="https://img.shields.io/badge/support%20forums-navy?style=for-the-badge&logo=github" height="25" />
    </a>
    <a href="https://github.com/neuralmagic/deepsparse/actions/workflows/quality-check.yaml">
      <img alt="Main" src="https://img.shields.io/github/workflow/status/neuralmagic/deepsparse/Quality%20Checks/main?label=build&style=for-the-badge" height="25" />
    </a>
    <a href="https://github.com/neuralmagic/deepsparse/releases">
      <img alt="GitHub release" src="https://img.shields.io/github/release/neuralmagic/deepsparse.svg?style=for-the-badge" height="25" />
    </a>
    <a href="https://github.com/neuralmagic/deepsparse/blob/main/CODE_OF_CONDUCT.md">
      <img alt="Contributor Covenant" src="https://img.shields.io/badge/Contributor%20Covenant-v2.1%20adopted-ff69b4.svg?color=yellow&style=for-the-badge" height="25" />
    </a>
    <a href="https://www.youtube.com/channel/UCo8dO_WMGYbWCRnj_Dxr4EA">
      <img alt="YouTube" src="https://img.shields.io/badge/-YouTube-red?&style=for-the-badge&logo=youtube&logoColor=white" height="25" />
    </a>
    <a href="https://medium.com/limitlessai">
      <img alt="Medium" src="https://img.shields.io/badge/medium-%2312100E.svg?&style=for-the-badge&logo=medium&logoColor=white" height="25" />
    </a>
    <a href="https://twitter.com/neuralmagic">
      <img alt="Twitter" src="https://img.shields.io/twitter/follow/neuralmagic?color=darkgreen&label=Follow&style=social" height="25" />
    </a>
  </div>
</div>

<p><br></p>
DeepSparse is an inference runtime that offers GPU-class performance on CPUs by utilizing sparsity. DeepSparse accepts models in the ONNX format, giving your flexibility to serve your model in a framework-agnostic manner.
DeepSparse Enterprise requires a Trial License or [can be fully licensed](https://neuralmagic.com/legal/master-software-license-and-service-agreement/) for production, commercial applications. (Alternatively, the [The Community Edition](https://docs.neuralmagic.com/products/deepsparse) is open-source and free for evaluation, research, and non-production.)

Neural Magic's DeepSparse is able to integrate into popular deep learning libraries (e.g., Hugging Face, Ultralytics) allowing you to leverage DeepSparse for loading and deploying sparse models with ONNX.
ONNX gives the flexibility to serve your model in a framework-agnostic environment.
Support includes [PyTorch,](https://pytorch.org/docs/stable/onnx.html) [TensorFlow,](https://github.com/onnx/tensorflow-onnx) [Keras,](https://github.com/onnx/keras-onnx) and [many other frameworks](https://github.com/onnx/onnxmltools).

DeepSparse is available in two editions:
1. [**DeepSparse Community**](https://docs.neuralmagic.com/products/deepsparse) is open-source and free for evaluation, research, and non-production use with our [DeepSparse Community License](https://neuralmagic.com/legal/engine-license-agreement/).
2. [**DeepSparse Enterprise**](#installation) requires a Trial License or [can be fully licensed](https://neuralmagic.com/legal/master-software-license-and-service-agreement/) for production, commercial applications.

## Features

- üîå [DeepSparse Server](https://github.com/neuralmagic/deepsparse/tree/main/src/deepsparse/server)
- üìú [DeepSparse Benchmark](https://github.com/neuralmagic/deepsparse/tree/main/src/deepsparse/benchmark)
- üë©‚Äçüíª [NLP and Computer Vision Tasks Supported](https://github.com/neuralmagic/deepsparse/tree/main/examples)

## üß∞ Hardware Support and System Requirements

Review [Supported Hardware for DeepSparse](/user-guide/deepsparse-engine/hardware-support) to understand system requirements.
DeepSparse works natively on Linux. Mac and Windows require running Linux in a Docker or virtual machine; it will not run natively on those operating systems.

DeepSparse is tested on Python 3.7-3.10, ONNX 1.5.0-1.12.0, ONNX opset version 11+, and manylinux compliant.
Using a [virtual environment](https://docs.python.org/3/library/venv.html) is highly recommended.

## Installation

Install DeepSparse Enterprise with `pip`:

```bash
pip install deepsparse-ent
```

See the [DeepSparse Enterprise Installation page](/get-started/install/deepsparse-ent) for further installation options.

## Getting a License

DeepSparse Enterprise requires a valid license to run the engine and can be licensed for production, commercial applications.
There are two options available:

### 90-Day Enterprise Trial License

To try out DeepSparse Enterprise and get a Neural Magic Trial License, complete our [registration form](https://neuralmagic.com/deepsparse-engine-free-trial).
Upon submission, the license will be emailed to you and your 90-day term starts right then.

### DeepSparse Enterprise License

To learn more about DeepSparse Enterprise pricing, [contact our Sales team](https://neuralmagic.com/deepsparse-engine/#form) to discuss your use case further for a custom quote.

## Installing a License

Once you have obtained a license, you will need to initialize it to be able to run DeepSparse Enterprise.
You can initialize your license by running:

```bash
deepsparse.license <license_string> or <path/to/license.txt>
```

To initialize a license on a machine:
1. Confirm you have deepsparse-ent installed in a fresh virtual environment.
   - Installing deepsparse and deepsparse-ent on the same virtual environment may result in unsupported behaviors.
2. Run `deepsparse.license` with the `<license_string>` or `path/to/license.txt` as an argument:
   - `deepsparse.license <samplelicensetring>`
   - `deepsparse.license ./license.txt`
3. If successful, `deepsparse.license` will write the license file to `~/.config/neuralmagic/license.txt`. You may overwrite this path by setting the environment variable `NM_CONFIG_DIR` (before and after running the script) with the following command:
   - `export NM_CONFIG_DIR=path/to/license.txt`
4. Once the license is authenticated, you should see a splash message indicating that you are now running DeepSparse Enterprise.

If you encounter issues initializing your DeepSparse Enterprise License, contact [license@neuralmagic.com](mailto:license@neuralmagic.com) for help.

## Validating a License

Once you have initialized your license, you may want to check that it is still valid before running a workload on DeepSparse Enterprise. To confirm your license is still active with DeepSparse Enterprise, run the command:

```bash
deepsparse.validate_license
```

`deepsparse.validate_license` can be run with no arguments, which will reference an existing environment variable (if set), or with one argument that is a reference to the license and can be referenced in the `deepsparse.validate_license` command as  `path/to/license.txt`.

To validate a license on a machine:
1. If you have successfully run `deepsparse.license`, `deepsparse.validate_license` can be used to validate that the license file is in the correct location:
   - Run the `deepsparse.validate_license` with no arguments. If the referenced license is valid, the DeepSparse Enterprise splash screen should display in your terminal window.
   - If the `NM_CONFIG_DIR` environment variable was set when creating the license, ensure this variable is still set to the same value.
2. If you want to supply the `path/to/license.txt`:
   - Run `deepsparse.validate_license` with `path/to/license.txt` as an argument as:<br>
   `deepsparse.validate_license --license_path path/to/license.txt`
   - If the referenced license is valid, the DeepSparse Enterprise splash screen should display in your terminal window.

## DeepSparse Enterprise Features

### DeepSparse Server

The DeepSparse Server allows you to serve models and pipelines from the terminal. The server runs on top of the popular FastAPI web framework and Uvicorn web server.

Install the server with `pip`:

```bash
pip install deepsparse-ent[server]
```

#### Single Model

Once installed, the following example CLI command is available for running inference with a single BERT model:

```bash
deepsparse.server \
    task question_answering \
    --model_path "zoo:nlp/question_answering/bert-base/pytorch/huggingface/squad/12layer_pruned80_quant-none-vnni"
```

To look up arguments run, `deepsparse.server --help`.

#### Multiple Models
To serve multiple models in your deployment you can easily build a `config.yaml`. In the example below, we define two BERT models in our configuration for the question answering task:

```yaml
num_cores: 1
num_workers: 1
endpoints:
    - task: question_answering
      route: /predict/question_answering/base
      model: zoo:nlp/question_answering/bert-base/pytorch/huggingface/squad/base-none
      batch_size: 1
    - task: question_answering
      route: /predict/question_answering/pruned_quant
      model: zoo:nlp/question_answering/bert-base/pytorch/huggingface/squad/12layer_pruned80_quant-none-vnni
      batch_size: 1
```

Finally, after your `config.yaml` file is built, run the server with the configuration file path as an argument:
```bash
deepsparse.server config config.yaml
```

See [Getting Started with DeepSparse Server](https://github.com/neuralmagic/deepsparse/tree/main/src/deepsparse/server) for more information.

### DeepSparse Benchmark

The benchmark tool is available on your CLI to run expressive model benchmarks with DeepSparse.

Run `deepsparse.benchmark -h` to look up arguments:

```shell
deepsparse.benchmark [-h] [-b BATCH_SIZE] [-shapes INPUT_SHAPES]
                          [-ncores NUM_CORES] [-s {async,sync}] [-t TIME]
                          [-nstreams NUM_STREAMS] [-pin {none,core,numa}]
                          [-q] [-x EXPORT_PATH]
                          model_path

```

[Getting Started with CLI Benchmarking](https://github.com/neuralmagic/deepsparse/tree/main/src/deepsparse/benchmark) includes examples of select inference scenarios:
- Synchronous (Single-stream) Scenario
- Asynchronous (Multi-stream) Scenario


### NLP and Computer Vision Tasks Supported

An NLP inference example is:

```python
from deepsparse import Pipeline

# SparseZoo model stub or path to ONNX file
model_path = "zoo:nlp/question_answering/bert-base/pytorch/huggingface/squad/12layer_pruned80_quant-none-vnni"

qa_pipeline = Pipeline.create(
    task="question-answering",
    model_path=model_path,
)

my_name = qa_pipeline(question="What's my name?", context="My name is Snorlax")
```

Refer also to [NLP and Computer Vision Tasks Supported](https://github.com/neuralmagic/deepsparse/blob/main/src/deepsparse/PIPELINES.md).

For NLP tutorials, see [Getting Started with Hugging Face Transformers](https://github.com/neuralmagic/deepsparse/tree/main/examples/huggingface-transformers).

- For Image Classification tutorials, see [Image Classification Inference Pipelines](https://github.com/neuralmagic/deepsparse/tree/main/src/deepsparse/image_classification).

- For Object Detection tutorials, see [YOLOv5 Inference Pipelines](https://github.com/neuralmagic/deepsparse/tree/main/src/deepsparse/yolo). 

- For Segmentation tutorials, see [YOLACT Inference Pipelines](https://github.com/neuralmagic/deepsparse/tree/main/src/deepsparse/yolact).

Supported NLP tasks include:
- [Token Classification: Named Entity Recognition](https://neuralmagic.com/use-cases/sparse-named-entity-recognition/)
- [Text Classification: Multi-Class](https://neuralmagic.com/use-cases/sparse-multi-class-text-classification/)
- [Text Classification: Binary](https://neuralmagic.com/use-cases/sparse-binary-text-classification/)
- [Text Classification: Sentiment Analysis](https://neuralmagic.com/use-cases/sparse-sentiment-analysis/)
- [Question Answering](https://neuralmagic.com/use-cases/sparse-question-answering/)

### SparseZoo ONNX vs. Custom ONNX Models

DeepSparse can accept ONNX models from two sources:

- **SparseZoo ONNX**: [SparseZoo](https://github.com/neuralmagic/sparsezoo) hosts open-source inference-optimized models, trained on repeatable sparsification recipes using state-of-the-art techniques from [SparseML](https://github.com/neuralmagic/sparseml). The ONNX representation of each model is available for download.

- **Custom ONNX**: DeepSparse allows you to use your own model in ONNX format. It can be dense or sparse. Plug in your model to compare performance with other solutions.

```bash
> wget https://github.com/onnx/models/raw/main/vision/classification/mobilenet/model/mobilenetv2-7.onnx
Saving to: ‚Äòmobilenetv2-7.onnx‚Äô
```

Here is a custom ONNX Benchmark example:
```python
from deepsparse import compile_model
from deepsparse.utils import generate_random_inputs
onnx_filepath = "mobilenetv2-7.onnx"
batch_size = 16

# Generate random sample input
inputs = generate_random_inputs(onnx_filepath, batch_size)

# Compile and run
engine = compile_model(onnx_filepath, batch_size)
outputs = engine.run(inputs)
```

The [GitHub repository](https://github.com/neuralmagic/deepsparse) includes package APIs along with examples to quickly get started benchmarking and inferencing sparse models.

### Scheduling Single-Stream, Multi-Stream, and Elastic Inference

DeepSparse offers three inference modes based on your use case. Refer also to [Inference Modes](https://github.com/neuralmagic/deepsparse/blob/main/docs/source/scheduler.md).

1. Single-stream scheduling (the default) is the latency/synchronous scenario. Requests execute serially.
<br><img src="https://raw.githubusercontent.com/neuralmagic/deepsparse/main/docs/source/single-stream.png" alt="single stream diagram" />
<br>Use Case: It's highly optimized for minimum per-request latency, using all of the system's resources provided to it on every request it gets.

2. Multi-stream scheduling is the throughput/asynchronous scenario. Requests execute in parallel.
<br><img src="https://raw.githubusercontent.com/neuralmagic/deepsparse/main/docs/source/multi-stream.png" alt="multi stream diagram" />
<br>Use Case: The most common use cases for the multi-stream scheduler are those in which parallelism is low with respect to core count, and requests need to be made asynchronously without time to batch them.

3. Elastic scheduling requests execute in parallel, but not multiplexed on individual NUMA nodes.
<br>Use Case: A workload that might benefit from the elastic scheduler is one in which multiple requests need to be handled simultaneously, but where performance is hindered when those requests have to share an L3 cache.

## Resources
#### Libraries
- [DeepSparse](https://docs.neuralmagic.com/products/deepsparse/)
- [SparseML](https://docs.neuralmagic.com/products/sparseml/)
- [SparseZoo](https://docs.neuralmagic.com/products/sparsezoo/)
- [Sparsify](https://docs.neuralmagic.com/products/sparsify/)


#### Versions
- [DeepSparse](https://pypi.org/project/deepsparse) | stable
- [DeepSparse-Nightly](https://pypi.org/project/deepsparse-nightly/) | nightly (dev)
- [GitHub](https://github.com/neuralmagic/deepsparse/releases) | releases

#### Info

- [Blog](https://www.neuralmagic.com/blog/)
- [Resources](https://www.neuralmagic.com/resources/)

### License

[DeepSparse Enterprise](https://docs.neuralmagic.com/products/deepsparse-ent) requires a Trial License or [can be fully licensed](https://neuralmagic.com/legal/master-software-license-and-service-agreement/) for production, commercial applications.
