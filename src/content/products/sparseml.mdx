---
title: "SparseML"
metaTitle: "SparseML"
metaDescription: "Sparsity-aware neural network inference engine for GPU-class performance on CPUs"
githubURL: "https://github.com/neuralmagic/docs/blob/main/src/content/products/sparseml.mdx"
index: 2000
---

# SparseML

### Libraries enabling creation of sparse deep-neural networks trained on your data with just a few lines of code

<p>
  <a href="https://docs.neuralmagic.com/sparseml/">
    <img alt="Documentation" src="https://img.shields.io/badge/documentation-darkred?&style=for-the-badge&logo=read-the-docs" height={25} />
  </a>
  <a href="https://join.slack.com/t/discuss-neuralmagic/shared_invite/zt-q1a1cnvo-YBoICSIw3L1dmQpjBeDurQ/">
    <img src="https://img.shields.io/badge/slack-purple?style=for-the-badge&logo=slack" height={25} />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/issues">
    <img src="https://img.shields.io/badge/support%20forums-navy?style=for-the-badge&logo=github" height={25} />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/actions/workflows/test-check.yaml">
    <img alt="Main" src="https://img.shields.io/github/workflow/status/neuralmagic/sparseml/Test%20Checks/main?label=build&style=for-the-badge" height={25} />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/releases">
    <img alt="GitHub release" src="https://img.shields.io/github/release/neuralmagic/sparseml.svg?style=for-the-badge" height={25} />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/blob/main/LICENSE">
    <img alt="GitHub" src="https://img.shields.io/github/license/neuralmagic/sparseml.svg?color=lightgray&style=for-the-badge" height={25} />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/blob/main/CODE_OF_CONDUCT.md">
    <img alt="Contributor Covenant" src="https://img.shields.io/badge/Contributor%20Covenant-v2.1%20adopted-ff69b4.svg?color=yellow&style=for-the-badge" height={25} />
  </a>
  <a href="https://www.youtube.com/channel/UCo8dO_WMGYbWCRnj_Dxr4EA">
    <img src="https://img.shields.io/badge/-YouTube-red?&style=for-the-badge&logo=youtube&logoColor=white" height={25} />
  </a>
  <a href="https://medium.com/limitlessai">
    <img src="https://img.shields.io/badge/medium-%2312100E.svg?&style=for-the-badge&logo=medium&logoColor=white" height={25} />
  </a>
  <a href="https://twitter.com/neuralmagic">
    <img src="https://img.shields.io/twitter/follow/neuralmagic?color=darkgreen&label=Follow&style=social" height={25} />
  </a>
</p>

## Overview

SparseML is a toolkit that includes APIs, CLIs, scripts and libraries that enable you to create sparse models trained on your data.

SparseML provides two options to accomplish this goal: 
- **Sparse Transfer Learning**: Fine-tune state-of-the-art pre-sparsified models from the SparseZoo onto your dataset while preserving sparsity.

- **Sparsifying from Scratch**: Apply state-of-the-art [sparsification](https://docs.neuralmagic.com/main/source/getstarted.html#sparsification) algorithms such as pruning and quantization to any neural network.

These options are useful for different situations:
- **Sparse Transfer Learning** is the easiest path to creating a sparse model trained on your data. Pull down a sparse model from SparseZoo and point our training scripts at your data without any hyperparameter search. This is the recommended pathway for supported use cases like Image Classification, Object Detection, and several NLP tasks. 

- **Sparsifying from Scratch** gives you the flexibility to prune any neural network for any use case, but requires more training epochs and hand-tuning hyperparameters.

Each of these avenues use YAML-based **recipes** that simplify integration with popular deep learning libraries and framrworks.

<img alt="SparseML Flow" src="https://docs.neuralmagic.com/docs/source/infographics/sparseml.png" width="100%" style={{maxWidth: "100%"}} />

## Highlights

### Integrations

<p>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/pytorch">
    <img src="https://docs.neuralmagic.com/docs/source/highlights/sparseml/pytorch-torchvision.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/ultralytics-yolov3">
    <img src="https://docs.neuralmagic.com/docs/source/highlights/sparseml/ultralytics-yolov3.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/ultralytics-yolov5">
    <img src="https://docs.neuralmagic.com/docs/source/highlights/sparseml/ultralytics-yolov5.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/huggingface-transformers">
    <img src="https://docs.neuralmagic.com/docs/source/highlights/sparseml/huggingface-transformers.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/rwightman-timm">
    <img src="https://docs.neuralmagic.com/docs/source/highlights/sparseml/rwightman-timm.png" width="136px" />
  </a>
</p>

### Creating Sparse Models

<p>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/pytorch/notebooks/classification.ipynb">
    <img src="https://docs.neuralmagic.com/docs/source/tutorials/classification_resnet-50.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/ultralytics-yolov3/tutorials/sparsifying_yolov3_using_recipes.md">
    <img src="https://docs.neuralmagic.com/docs/source/tutorials/detection_yolov3.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/ultralytics-yolov5/tutorials/sparsifying_yolov5_using_recipes.md">
    <img src="https://docs.neuralmagic.com/docs/source/tutorials/detection_yolov5.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/huggingface-transformers/tutorials/sparsifying_bert_using_recipes.md">
    <img src="https://docs.neuralmagic.com/docs/source/tutorials/nlp_bert.png" width="136px" />
  </a>
</p>

### Transfer Learning from Sparse Models

<p>
  <a href="https://github.com/neuralmagic/sparseml/tree/main/integrations/pytorch/notebooks/sparse_quantized_transfer_learning.ipynb">
    <img src="https://docs.neuralmagic.com/docs/source/tutorials/classification_resnet-50.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/blob/main/integrations/ultralytics-yolov3/tutorials/yolov3_sparse_transfer_learning.md">
    <img src="https://docs.neuralmagic.com/docs/source/tutorials/detection_yolov3.png" width="136px" />
  </a>
  <a href="https://github.com/neuralmagic/sparseml/blob/main/integrations/ultralytics-yolov5/tutorials/yolov5_sparse_transfer_learning.md">
    <img src="https://docs.neuralmagic.com/docs/source/tutorials/detection_yolov5.png" width="136px" />
  </a>
</p>


## Tutorials

### üñºÔ∏è Computer Vision

- [Sparsifying PyTorch Models Using Recipes](https://github.com/neuralmagic/sparseml/blob/main/integrations/pytorch/tutorials/sparsifying_pytorch_models_using_recipes.md)
- [Sparsifying YOLOv3 Using Recipes](https://github.com/neuralmagic/sparseml/blob/main/integrations/ultralytics-yolov3/tutorials/sparsifying_yolov3_using_recipes.md)
- [Sparsifying YOLOv5 Using Recipes](https://github.com/neuralmagic/sparseml/blob/main/integrations/ultralytics-yolov5/tutorials/sparsifying_yolov5_using_recipes.md)
- [Sparsifying YOLACT Using Recipes](https://github.com/neuralmagic/sparseml/blob/main/integrations/dbolya-yolact/tutorials/sparsifying_yolact_using_recipes.md)
- [Sparse Transfer Learning for Image Classification](https://github.com/neuralmagic/sparseml/blob/main/integrations/pytorch/tutorials/classification_sparse_transfer_learning_tutorial.md)
- [Sparse Transfer Learning With YOLOv3](https://github.com/neuralmagic/sparseml/blob/main/integrations/ultralytics-yolov3/tutorials/yolov3_sparse_transfer_learning.md)
- [Sparse Transfer Learning With YOLOv5](https://github.com/neuralmagic/sparseml/blob/main/integrations/ultralytics-yolov5/tutorials/yolov5_sparse_transfer_learning.md)

&emsp; **Notebooks**

- [Keras Image Classification Model Pruning Using SparseML](https://github.com/neuralmagic/sparseml/blob/main/integrations/keras/notebooks/classification.ipynb)
- [PyTorch Image Classification Model Pruning Using SparseML](https://github.com/neuralmagic/sparseml/blob/main/integrations/pytorch/notebooks/classification.ipynb)
- [PyTorch Image Detection Model Pruning Using SparseML](https://github.com/neuralmagic/sparseml/blob/main/integrations/pytorch/notebooks/detection.ipynb)
- [Sparse-Quantized Transfer Learning in PyTorch Using SparseML](https://github.com/neuralmagic/sparseml/blob/main/integrations/pytorch/notebooks/sparse_quantized_transfer_learning.ipynb)
- [Torchvision Classification Model Pruning Using SparseML](https://github.com/neuralmagic/sparseml/blob/main/integrations/pytorch/notebooks/torchvision.ipynb)
- [TensorFlow v1 Classification Model Pruning Using SparseML](https://github.com/neuralmagic/sparseml/blob/main/integrations/tensorflow_v1/notebooks/classification.ipynb)

### üì∞ NLP
- [Sparsifying BERT Models Using Recipes](https://github.com/neuralmagic/sparseml/blob/main/integrations/huggingface-transformers/tutorials/sparsifying_bert_using_recipes.md)
- [Sparse Transfer Learning With BERT](https://github.com/neuralmagic/sparseml/blob/main/integrations/huggingface-transformers/tutorials/bert_sparse_transfer_learning.md)


## Installation Requirements

See the [SparseML Installation Page](/get-started/install/sparseml) for install instructions.

## Quick Tour

SparseML enables you to create a sparse model with **Sparse Transfer Learning** and **Sparsification from Scratch**.

To enable flexibility, ease of use, and repeatability, each piece of functionality is accomplished via recipes.
  The recipes encode the instructions needed for modifying the model and/or training process as a list of modifiers.
  Example modifiers can be anything from setting the learning rate for the optimizer to gradual magnitude pruning.
  The files are written in [YAML](https://yaml.org/) and stored in YAML or [markdown](https://www.markdownguide.org/) files using [YAML front matter.](https://assemble.io/docs/YAML-front-matter.html) The rest of the SparseML system is coded to parse the recipes into a native format for the desired framework and apply the modifications to the model and training pipeline.

To give a sense of the flavor of what recipes encode, some examples are below:
- Recipes for **Sparse Transfer Learning** usually include the `!ConstantPruningModifier`, which instructs SparseML to maintian the starting level of sparsity while fine-tuning.

- Recipes for **Sparsification from Scratch** usually include the `!GMPruningModifier`, which instructs SparseML to iteratively prune the layers of the model to certain levels (e.g. 80%) over which epochs.

Recipes are then integrated into deep learning training workflows in one of two ways:

#### For Supported Use Cases: CLI

SparseML provides command line scripts that accept recipes as arguments and perform Sparse Transfer Learning and Sparsification from Scratch. We highly
reccomended using the command line scripts. Appending `--help` to the commands demonstrates the full list of arguments.

For example, the following command kicks off **Sparse Transfer Learning** from pre-sparsified YOLOv5 onto the VOC dataset using the pre-made recipes in the SparseZoo:

```bash
$ sparseml.yolov5.train \
    --data VOC.yaml \
    --cfg models_v5.0/yolov5l.yaml \
    --weights zoo:cv/detection/yolov5-l/pytorch/ultralytics/coco/pruned_quant-aggressive_95?recipe_type=transfer \
    --hyp data/hyps/hyp.finetune.yaml \
    --recipe zoo:cv/detection/yolov5-l/pytorch/ultralytics/coco/pruned_quant-aggressive_95?recipe_type=transfer
```

For example, the following command kicks off **Sparsification of a dense YOLOv5 model from Scratch** using the pre-made recipes in the SparseZoo:

```bash
$ sparseml.yolov5.train \  
    --cfg models_v5.0/yolov5l.yaml \
    --weights yolov5l.pt \
    --data coco.yaml \
    --hyp data/hyps/hyp.scratch.yaml \
    --recipe zoo:cv/detection/yolov5-l/pytorch/ultralytics/coco/pruned_quant-aggressive_95
```

For more details on the above as well as examples for more supported use cases see [here](/use-cases/natural-language-processing/question-answering).

#### For Custom Use Cases / Supported Use Cases: Python Integration

The `ScheduledModifierManager` class is used to modify the standard training workflows for both Sparse Transfer Learning
and Sparsification from Scratch. It can be used in PyTorch and TensorFlow/Keras.

The manager classes works by overriding the `model` and `optimizers` to encode sparsity logic.
  Managers can apply recipes in one shot or training aware ways.
  One shot is invoked by calling `.apply(...)` on the manager while training aware requires calls into `initialize(...)` (optional), `modify(...)`, and `finalize(...)`.
  This means only a few lines of code need to be added to begin transfer learning or sparsifying from scratch with pruning and quantization.
  
For example, the following applies a recipe in a training-aware manner:

  ```python
model = Model()  # model definition
optimizer = Optimizer()  # optimizer definition
train_data = TrainData()  # train data definition
batch_size = BATCH_SIZE  # training batch size
steps_per_epoch = len(train_data) // batch_size

  from sparseml.pytorch.optim import ScheduledModifierManager
  manager = ScheduledModifierManager.from_yaml(PATH_TO_RECIPE)
  optimizer = manager.modify(model, optimizer, steps_per_epoch)

  # ... PyTorch training loop as usual ...

  manager.finalize(model)
```

Instead of training aware, the following example code shows how to execute a recipe in a one shot manner:
  ```python
model = Model()  # model definition

  from sparseml.pytorch.optim import ScheduledModifierManager
  manager = ScheduledModifierManager.from_yaml(PATH_TO_RECIPE)
  manager.apply(model)
```

More information on the codebase and contained processes can be found in the SparseML docs:
- [Sparse Transfer Learning](/get-started/transfer-a-sparsified-model)
- [Sparsification Code](/get-started/sparsify-a-model)
- [Sparsification Recipes](/user-guide/recipes)
- [Exporting to ONNX](/user-guide/sparsification)

## Resources

### Learning More

- Documentation: [SparseML,](https://docs.neuralmagic.com/sparseml/) [SparseZoo,](https://docs.neuralmagic.com/sparsezoo/) [Sparsify,](https://docs.neuralmagic.com/sparsify/) [DeepSparse](https://docs.neuralmagic.com/deepsparse/)
- Neural Magic: [Blog,](https://www.neuralmagic.com/blog/) [Resources](https://www.neuralmagic.com/resources/)

### Release History

Official builds are hosted on PyPI

- stable: [sparseml](https://pypi.org/project/sparseml/)
- nightly (dev): [sparseml-nightly](https://pypi.org/project/sparseml-nightly/)

Additionally, more information can be found via [GitHub Releases.](https://github.com/neuralmagic/sparseml/releases)

### License

The project is licensed under the [Apache License Version 2.0.](https://github.com/neuralmagic/sparseml/blob/main/LICENSE)

## Community

### Contribute

We appreciate contributions to the code, examples, integrations, and documentation as well as bug reports and feature requests! [Learn how here.](https://github.com/neuralmagic/sparseml/blob/main/CONTRIBUTING.md)

### Join

For user help or questions about SparseML, sign up or log in to our [**Deep Sparse Community Slack**](https://join.slack.com/t/discuss-neuralmagic/shared_invite/zt-q1a1cnvo-YBoICSIw3L1dmQpjBeDurQ). We are growing the community member by member and happy to see you there. Bugs, feature requests, or additional questions can also be posted to our [GitHub Issue Queue.](https://github.com/neuralmagic/sparseml/issues)

You can get the latest news, webinar and event invites, research papers, and other ML Performance tidbits by [subscribing](https://neuralmagic.com/subscribe/) to the Neural Magic community.

For more general questions about Neural Magic, please fill out this [form.](http://neuralmagic.com/contact/)

### Cite

Find this project useful in your research or other communications? Please consider citing:

```bibtex
@InProceedings{
    pmlr-v119-kurtz20a,
    title = {Inducing and Exploiting Activation Sparsity for Fast Inference on Deep Neural Networks},
    author = {Kurtz, Mark and Kopinsky, Justin and Gelashvili, Rati and Matveev, Alexander and Carr, John and Goin, Michael and Leiserson, William and Moore, Sage and Nell, Bill and Shavit, Nir and Alistarh, Dan},
    booktitle = {Proceedings of the 37th International Conference on Machine Learning},
    pages = {5533--5543},
    year = {2020},
    editor = {Hal Daum√© III and Aarti Singh},
    volume = {119},
    series = {Proceedings of Machine Learning Research},
    address = {Virtual},
    month = {13--18 Jul},
    publisher = {PMLR},
    pdf = {http://proceedings.mlr.press/v119/kurtz20a/kurtz20a.pdf},
    url = {http://proceedings.mlr.press/v119/kurtz20a.html},
    abstract = {Optimizing convolutional neural networks for fast inference has recently become an extremely active area of research. One of the go-to solutions in this context is weight pruning, which aims to reduce computational and memory footprint by removing large subsets of the connections in a neural network. Surprisingly, much less attention has been given to exploiting sparsity in the activation maps, which tend to be naturally sparse in many settings thanks to the structure of rectified linear (ReLU) activation functions. In this paper, we present an in-depth analysis of methods for maximizing the sparsity of the activations in a trained neural network, and show that, when coupled with an efficient sparse-input convolution algorithm, we can leverage this sparsity for significant performance gains. To induce highly sparse activation maps without accuracy loss, we introduce a new regularization technique, coupled with a new threshold-based sparsification method based on a parameterized activation function called Forced-Activation-Threshold Rectified Linear Unit (FATReLU). We examine the impact of our methods on popular image classification models, showing that most architectures can adapt to significantly sparser activation maps without any accuracy loss. Our second contribution is showing that these these compression gains can be translated into inference speedups: we provide a new algorithm to enable fast convolution operations over networks with sparse activations, and show that it can enable significant speedups for end-to-end inference on a range of popular models on the large-scale ImageNet image classification task on modern Intel CPUs, with little or no retraining cost.}
}
```

```bibtex
@misc{
    singh2020woodfisher,
    title={WoodFisher: Efficient Second-Order Approximation for Neural Network Compression},
    author={Sidak Pal Singh and Dan Alistarh},
    year={2020},
    eprint={2004.14340},
    archivePrefix={arXiv},
    primaryClass={cs.LG}
}
```
