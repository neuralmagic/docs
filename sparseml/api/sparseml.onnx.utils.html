

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>sparseml.onnx.utils package &mdash; SparseML 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sparseml.optim package" href="sparseml.optim.html" />
    <link rel="prev" title="sparseml.onnx.optim.quantization package" href="sparseml.onnx.optim.quantization.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> SparseML
          

          
            
            <img src="../_static/icon-sparseml.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quicktour.html">Quick Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes.html">Sparsification Recipes</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="sparseml.html">sparseml package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="sparseml.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="sparseml.keras.html">sparseml.keras package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="sparseml.onnx.html">sparseml.onnx package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="sparseml.onnx.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="sparseml.onnx.html#module-sparseml.onnx">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sparseml.optim.html">sparseml.optim package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparseml.pytorch.html">sparseml.pytorch package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparseml.tensorflow_v1.html">sparseml.tensorflow_v1 package</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparseml.utils.html">sparseml.utils package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sparseml.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparseml.html#module-sparseml.log">sparseml.log module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparseml.html#module-sparseml">Module contents</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Help</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/neuralmagic/sparseml/issues">Bugs, Feature Requests</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/neuralmagic/sparseml/discussions">Support, General Q&amp;A</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.neuralmagic.com">Neural Magic Docs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SparseML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="sparseml.html">sparseml package</a> &raquo;</li>
        
          <li><a href="sparseml.onnx.html">sparseml.onnx package</a> &raquo;</li>
        
      <li>sparseml.onnx.utils package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/sparseml.onnx.utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sparseml-onnx-utils-package">
<h1>sparseml.onnx.utils package<a class="headerlink" href="#sparseml-onnx-utils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-sparseml.onnx.utils.data">
<span id="sparseml-onnx-utils-data-module"></span><h2>sparseml.onnx.utils.data module<a class="headerlink" href="#module-sparseml.onnx.utils.data" title="Permalink to this headline">¶</a></h2>
<p>Utilities for data loading into numpy for use in ONNX supported systems</p>
<dl class="py class">
<dt id="sparseml.onnx.utils.data.DataLoader">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.data.</code><code class="sig-name descname">DataLoader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>List<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">labels</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>None<span class="p">, </span>str<span class="p">, </span>List<span class="p">[</span>Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">iter_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/data.html#DataLoader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.data.DataLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data loader instance that supports loading numpy arrays from file or memory
and creating an iterator to go through batches of that data.</p>
<p>Iterator returns a tuple containing (data, label).
label is only returned if label data was passed in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – a file glob pointing to numpy files, path to a tar ball of numpy
files, or loaded numpy data</p></li>
<li><p><strong>labels</strong> – a file glob pointing to numpy files path to a tar ball of numpy
files, or loaded numpy data</p></li>
<li><p><strong>batch_size</strong> – the size of batches to create for the iterator</p></li>
<li><p><strong>iter_steps</strong> – the number of steps (batches) to create.
Set to -1 for infinite, 0 for running through the loaded data once,
or a positive integer for the desired number of steps</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="sparseml.onnx.utils.data.DataLoader.batch_size">
<em class="property">property </em><code class="sig-name descname">batch_size</code><a class="headerlink" href="#sparseml.onnx.utils.data.DataLoader.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>the size of batches to create for the iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>return</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.data.DataLoader.from_model_random">
<em class="property">static </em><code class="sig-name descname">from_model_random</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">iter_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">num_samples</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">100</span></em>, <em class="sig-param"><span class="n">create_labels</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">strip_first_dim</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/data.html#DataLoader.from_model_random"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.data.DataLoader.from_model_random" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DataLoader from random data for a model’s input and output sizes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the loaded model or a file path to the onnx model
to create random data for</p></li>
<li><p><strong>batch_size</strong> – the size of batches to create for the iterator</p></li>
<li><p><strong>iter_steps</strong> – the number of steps (batches) to create.
Set to -1 for infinite, 0 for running through the loaded data once,
or a positive integer for the desired number of steps</p></li>
<li><p><strong>num_samples</strong> – number of random samples to create</p></li>
<li><p><strong>create_labels</strong> – True to create random label data as well, False otherwise</p></li>
<li><p><strong>strip_first_dim</strong> – True to strip the first dimension from the inputs
and outputs, typically the batch dimension</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the created DataLoader instance with the random data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.data.DataLoader.from_random">
<em class="property">static </em><code class="sig-name descname">from_random</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_shapes</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span><span class="p">…</span><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">label_shapes</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>None<span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">, </span><span class="p">…</span><span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">iter_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">num_samples</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">100</span></em>, <em class="sig-param"><span class="n">data_types</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.dtype<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/data.html#DataLoader.from_random"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.data.DataLoader.from_random" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a DataLoader from random data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_shapes</strong> – shapes to create for the data items</p></li>
<li><p><strong>label_shapes</strong> – shapes to create for the label items</p></li>
<li><p><strong>batch_size</strong> – the size of batches to create for the iterator</p></li>
<li><p><strong>iter_steps</strong> – the number of steps (batches) to create.
Set to -1 for infinite, 0 for running through the loaded data once,
or a positive integer for the desired number of steps</p></li>
<li><p><strong>num_samples</strong> – number of random samples to create</p></li>
<li><p><strong>data_types</strong> – optional numpy data types for each of the data items</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the created DataLoader instance with the random data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.data.DataLoader.infinite">
<em class="property">property </em><code class="sig-name descname">infinite</code><a class="headerlink" href="#sparseml.onnx.utils.data.DataLoader.infinite" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the loader instance is setup to continually create batches,
False otherwise</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>return</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.data.DataLoader.iter_steps">
<em class="property">property </em><code class="sig-name descname">iter_steps</code><a class="headerlink" href="#sparseml.onnx.utils.data.DataLoader.iter_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of steps (batches) to create.
Set to -1 for infinite, 0 for running through the loaded data once,
or a positive integer for the desired number of steps</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>return</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.data.DataLoader.labeled_data">
<em class="property">property </em><code class="sig-name descname">labeled_data</code><a class="headerlink" href="#sparseml.onnx.utils.data.DataLoader.labeled_data" title="Permalink to this definition">¶</a></dt>
<dd><p>the loaded data and labels</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>return</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sparseml.onnx.utils.graph_editor">
<span id="sparseml-onnx-utils-graph-editor-module"></span><h2>sparseml.onnx.utils.graph_editor module<a class="headerlink" href="#module-sparseml.onnx.utils.graph_editor" title="Permalink to this headline">¶</a></h2>
<p>Helper functions to edit ONNX Graphs.</p>
<dl class="py function">
<dt id="sparseml.onnx.utils.graph_editor.override_model_batch_size">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_editor.</code><code class="sig-name descname">override_model_batch_size</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_editor.html#override_model_batch_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_editor.override_model_batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Rewrites any positive batch dimensions in the model inputs or outputs to the
given batch_size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Model to modify</p></li>
<li><p><strong>batch_size</strong> – Batch size to enforce</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the given model with inputs and outputs set to batch_size if the batch
dimensions are not -1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.graph_editor.prune_model_one_shot">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_editor.</code><code class="sig-name descname">prune_model_one_shot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">nodes</span><span class="p">:</span> <span class="n">List<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">sparsity</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>float<span class="p">, </span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_editor.html#prune_model_one_shot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_editor.prune_model_one_shot" title="Permalink to this definition">¶</a></dt>
<dd><p>Prune a model in-place with one shot pruning (no retraining) according to
magnitude pruning. Does so in an unstructured way currently</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model to apply pruning to</p></li>
<li><p><strong>nodes</strong> – the nodes within the model to prune to the desired sparsities</p></li>
<li><p><strong>sparsity</strong> – the sparsity level to prune all nodes to if a float,
or the sparsity level to prune each node to if a list of floats</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the new, pruned model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.graph_editor.prune_model_one_shot_iter">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_editor.</code><code class="sig-name descname">prune_model_one_shot_iter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">nodes</span><span class="p">:</span> <span class="n">List<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">sparsity</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>float<span class="p">, </span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_editor.html#prune_model_one_shot_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_editor.prune_model_one_shot_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively prune a model in-place with one shot pruning (no retraining) according
to magnitude pruning. Does so in an unstructured way currently</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model to apply pruning to</p></li>
<li><p><strong>nodes</strong> – the nodes within the model to prune to the desired sparsities</p></li>
<li><p><strong>sparsity</strong> – the sparsity level to prune all nodes to if a float,
or the sparsity level to prune each node to if a list of floats</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.graph_editor.prune_unstructured">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_editor.</code><code class="sig-name descname">prune_unstructured</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">sparsity</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_editor.html#prune_unstructured"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_editor.prune_unstructured" title="Permalink to this definition">¶</a></dt>
<dd><p>Prune a numpy array with unstructured sparsity according to magnitude pruning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – the array to prune (introduce zeros), will remove the lowest
absolute values in the array</p></li>
<li><p><strong>sparsity</strong> – the sparsity value, as a decimal, to impose in the array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the pruned array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.graph_editor.remove_node_and_params_from_graph">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_editor.</code><code class="sig-name descname">remove_node_and_params_from_graph</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em>, <em class="sig-param"><span class="n">keep_params</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Iterable<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_editor.html#remove_node_and_params_from_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_editor.remove_node_and_params_from_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a node from the mdoel graph as well as its parameters listed in node.input</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Model to delete from</p></li>
<li><p><strong>node</strong> – Node to delete</p></li>
<li><p><strong>keep_params</strong> – Names of node input initializers not to remove from graph
default is None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.graph_editor.swap_node_output">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_editor.</code><code class="sig-name descname">swap_node_output</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em>, <em class="sig-param"><span class="n">output</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_editor.html#swap_node_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_editor.swap_node_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes the current output of the node and replaces it with the provided value
Assumes that the node only has one output</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Node to change the output of</p></li>
<li><p><strong>output</strong> – New output value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.graph_editor.update_model_param">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_editor.</code><code class="sig-name descname">update_model_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">param_name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">val</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_editor.html#update_model_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_editor.update_model_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the parameter with name param_name from the model
Creates a new parameter using val
Adds val to the model with name param_name as an update</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The model to update</p></li>
<li><p><strong>param_name</strong> – The parameter name in the model to update</p></li>
<li><p><strong>val</strong> – The new value of the parameter</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-sparseml.onnx.utils.graph_optimizer">
<span id="sparseml-onnx-utils-graph-optimizer-module"></span><h2>sparseml.onnx.utils.graph_optimizer module<a class="headerlink" href="#module-sparseml.onnx.utils.graph_optimizer" title="Permalink to this headline">¶</a></h2>
<p>Helper functions to optimize ONNX Graphs.</p>
<dl class="py function">
<dt id="sparseml.onnx.utils.graph_optimizer.fold_conv_bns">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_optimizer.</code><code class="sig-name descname">fold_conv_bns</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">onnx_file</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_optimizer.html#fold_conv_bns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_optimizer.fold_conv_bns" title="Permalink to this definition">¶</a></dt>
<dd><p>When a batch norm op is the only child operator of a conv op, this function
will fold the batch norm into the conv and return the processed graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>onnx_file</strong> – file path to ONNX model to process</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A loaded ONNX model with BatchNormalization ops folded into Conv ops
where possible</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.graph_optimizer.quantize_resnet_identity_add_inputs">
<code class="sig-prename descclassname">sparseml.onnx.utils.graph_optimizer.</code><code class="sig-name descname">quantize_resnet_identity_add_inputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantized_model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/sparseml/onnx/utils/graph_optimizer.html#quantize_resnet_identity_add_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.graph_optimizer.quantize_resnet_identity_add_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>To avoid storing the identity value of a ResNet block in fp32, this optimization
will pass the identity value through the same quantize operation as the ResNet
block and add a de-quantize operation for the identity before the add.</p>
<p>Function will match to any add operation whose inputs are the output of a relu
or add op and a quantize -&gt; de-quantize block that takes the same relu as input.
Performs this optimization in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>quantized_model</strong> – A loaded quantized model to performed this optimization on</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if an in-place optimization was made</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-sparseml.onnx.utils.helpers">
<span id="sparseml-onnx-utils-helpers-module"></span><h2>sparseml.onnx.utils.helpers module<a class="headerlink" href="#module-sparseml.onnx.utils.helpers" title="Permalink to this headline">¶</a></h2>
<p>Utility / helper functions</p>
<dl class="py class">
<dt id="sparseml.onnx.utils.helpers.BatchNormParams">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">BatchNormParams</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epsilon</span></em>, <em class="sig-param"><span class="n">momentum</span></em>, <em class="sig-param"><span class="n">scale</span></em>, <em class="sig-param"><span class="n">bias</span></em>, <em class="sig-param"><span class="n">mean</span></em>, <em class="sig-param"><span class="n">var</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sparseml.onnx.utils.helpers.BatchNormParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.BatchNormParams.bias">
<em class="property">property </em><code class="sig-name descname">bias</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.BatchNormParams.bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.BatchNormParams.epsilon">
<em class="property">property </em><code class="sig-name descname">epsilon</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.BatchNormParams.epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.BatchNormParams.mean">
<em class="property">property </em><code class="sig-name descname">mean</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.BatchNormParams.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.BatchNormParams.momentum">
<em class="property">property </em><code class="sig-name descname">momentum</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.BatchNormParams.momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.BatchNormParams.scale">
<em class="property">property </em><code class="sig-name descname">scale</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.BatchNormParams.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.BatchNormParams.var">
<em class="property">property </em><code class="sig-name descname">var</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.BatchNormParams.var" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sparseml.onnx.utils.helpers.NodeParam">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">NodeParam</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">val</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sparseml.onnx.utils.helpers.NodeParam" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.NodeParam.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.NodeParam.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.NodeParam.val">
<em class="property">property </em><code class="sig-name descname">val</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.NodeParam.val" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sparseml.onnx.utils.helpers.NodeShape">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">NodeShape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">id</span></em>, <em class="sig-param"><span class="n">input_shapes</span></em>, <em class="sig-param"><span class="n">output_shapes</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sparseml.onnx.utils.helpers.NodeShape" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.NodeShape.id">
<em class="property">property </em><code class="sig-name descname">id</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.NodeShape.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.NodeShape.input_shapes">
<em class="property">property </em><code class="sig-name descname">input_shapes</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.NodeShape.input_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.NodeShape.output_shapes">
<em class="property">property </em><code class="sig-name descname">output_shapes</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.NodeShape.output_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sparseml.onnx.utils.helpers.SparsityMeasurement">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">SparsityMeasurement</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_id</span></em>, <em class="sig-param"><span class="n">params_count</span></em>, <em class="sig-param"><span class="n">params_zero_count</span></em>, <em class="sig-param"><span class="n">sparsity</span></em>, <em class="sig-param"><span class="n">density</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sparseml.onnx.utils.helpers.SparsityMeasurement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.SparsityMeasurement.density">
<em class="property">property </em><code class="sig-name descname">density</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.SparsityMeasurement.density" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.SparsityMeasurement.node_id">
<em class="property">property </em><code class="sig-name descname">node_id</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.SparsityMeasurement.node_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.SparsityMeasurement.params_count">
<em class="property">property </em><code class="sig-name descname">params_count</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.SparsityMeasurement.params_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.SparsityMeasurement.params_zero_count">
<em class="property">property </em><code class="sig-name descname">params_zero_count</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.SparsityMeasurement.params_zero_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.helpers.SparsityMeasurement.sparsity">
<em class="property">property </em><code class="sig-name descname">sparsity</code><a class="headerlink" href="#sparseml.onnx.utils.helpers.SparsityMeasurement.sparsity" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.calculate_flops">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">calculate_flops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">op_type</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">input_shape</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>List<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output_shape</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>List<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weight_shape</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kernel_shape</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bias_shape</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attributes</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>None<span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>Any<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>float<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#calculate_flops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.calculate_flops" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate flops based on operation type and shape of certain attributes.
If any fields necessary in operation are set to None, will return None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>op_type</strong> – Operation type of flop calculation</p></li>
<li><p><strong>input_shape</strong> – List of input shapes of operation</p></li>
<li><p><strong>output_shape</strong> – List of output shapes of operation</p></li>
<li><p><strong>weight_shape</strong> – Shape of weights in operation if any, else None</p></li>
<li><p><strong>kernel_shape</strong> – Shape of kernel in operation if any, else None</p></li>
<li><p><strong>bias_shape</strong> – Shape of bias in operation if any, else None</p></li>
<li><p><strong>attributes</strong> – The node attributes if any, else None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The amount of floating point operations in the operation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.check_load_model">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">check_load_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#check_load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.check_load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an ONNX model from a given file path if supplied.
If already a model proto, then returns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – the model proto or path to the model onnx file to check for loading</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the loaded onnx ModelProto</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.conv_node_params">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">conv_node_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em>, <em class="sig-param"><span class="n">include_values</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeParam" title="sparseml.onnx.utils.helpers.NodeParam">sparseml.onnx.utils.helpers.NodeParam</a><span class="p">, </span>Optional<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeParam" title="sparseml.onnx.utils.helpers.NodeParam">sparseml.onnx.utils.helpers.NodeParam</a><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#conv_node_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.conv_node_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the params (weight and bias) for a conv node in an onnx ModelProto</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>node</strong> – the conv node to get the params for</p></li>
<li><p><strong>include_values</strong> – True to include the param values as numpy arrays
in the returned NodeParam objects.
False to not load the values – in this event NodeParam.val will be None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the weight, bias (if it is present)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.extract_node_id">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">extract_node_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#extract_node_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.extract_node_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the node id for a given node from an onnx model.
Grabs the first ouput id as the node id.
This is because is guaranteed to be unique for this node by the onnx spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – the node to grab an id for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the id for the node</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.extract_node_shapes">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">extract_node_shapes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeShape" title="sparseml.onnx.utils.helpers.NodeShape">sparseml.onnx.utils.helpers.NodeShape</a><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#extract_node_shapes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.extract_node_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the shape information for each node as a NodeShape object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – the loaded onnx.ModelProto to extract node shape information from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a mapping of node id to a NodeShape object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.extract_nodes_shapes_ort">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">extract_nodes_shapes_ort</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>List<span class="p">[</span>List<span class="p">[</span>int<span class="p">]</span><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#extract_nodes_shapes_ort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.extract_nodes_shapes_ort" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a modified model to expose intermediate outputs and runs an onnxruntime
InferenceSession to obtain the output shape of each node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – an onnx model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of NodeArg with their shape exposed</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.extract_nodes_shapes_shape_inference">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">extract_nodes_shapes_shape_inference</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>List<span class="p">[</span>Union<span class="p">[</span>None<span class="p">, </span>List<span class="p">[</span>int<span class="p">]</span><span class="p">]</span><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#extract_nodes_shapes_shape_inference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.extract_nodes_shapes_shape_inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a modified model to expose intermediate outputs and runs an onnx shape
inference to obtain the output shape of each node.</p>
<p>NOTE: The Onnx docs on shape inference have the following
disclaimer on shape inference:
Shape inference is not guaranteed to be complete.
In particular, some dynamic behaviors block the flow of shape inference,
for example a Reshape to a dynamically-provide shape.
Also, all operators are not required to have a shape inference implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – an onnx model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of NodeProto with their shape exposed</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.extract_shape">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">extract_shape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">proto</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>None<span class="p">, </span>Tuple<span class="p">[</span>Optional<span class="p">[</span>int<span class="p">]</span><span class="p">, </span><span class="p">…</span><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#extract_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.extract_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the shape info from a proto.
Convenient for inputs into a model for example to get the tensor dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>proto</strong> – the proto to get tensor shape info for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing shape info if found, else None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.gemm_node_params">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">gemm_node_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em>, <em class="sig-param"><span class="n">include_values</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeParam" title="sparseml.onnx.utils.helpers.NodeParam">sparseml.onnx.utils.helpers.NodeParam</a><span class="p">, </span>Optional<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeParam" title="sparseml.onnx.utils.helpers.NodeParam">sparseml.onnx.utils.helpers.NodeParam</a><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#gemm_node_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.gemm_node_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the params (weight and bias) for a gemm node in an onnx ModelProto</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>node</strong> – the conv node to get the params for</p></li>
<li><p><strong>include_values</strong> – True to include the param values as numpy arrays
in the returned NodeParam objects.
False to not load the values – in this event NodeParam.val will be None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the weight, bias (if it is present)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_attr_float_val_for_node">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_attr_float_val_for_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em>, <em class="sig-param"><span class="n">attr</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>float<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_attr_float_val_for_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_attr_float_val_for_node" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> – Node to get the attribute value of</p></li>
<li><p><strong>attr</strong> – Attribute name to match in the node</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the attribute if the attribute found in the node and is
a float type. Otherwise returns None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_batch_norm_params">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_batch_norm_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">bn_node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sparseml.onnx.utils.helpers.BatchNormParams" title="sparseml.onnx.utils.helpers.BatchNormParams">sparseml.onnx.utils.helpers.BatchNormParams</a><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_batch_norm_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_batch_norm_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the params and relevant attributes of a batch normalization operator.
Following the onnx operators spec, will default epsilon and momentum to
1e-5 and 0.9 respectively when not defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>bn_node</strong> – the batch normalization node to get the params for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a BatchNormParams named tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_init_by_name">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_init_by_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">init_name</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>Any<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_init_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_init_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an initializer by name from the onnx model proto graph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>init_name</strong> – the name of the initializer to retrieve</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the initializer retrieved by name from the model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_kernel_shape">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_kernel_shape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">attributes</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>Any<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_kernel_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_kernel_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the kernel shape from a dictionary of a model’s attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attributes</strong> – a dictionary of a model’s attributes</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the kernel shape if attribute contains either the kernel or
kernel_shape field, otherwise None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_node_attributes">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_node_attributes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>Any<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_node_attributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_node_attributes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – the ONNX node to get the attibutes for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dictionary containing all attributes for the node</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_node_by_id">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_node_by_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node_id</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_node_by_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_node_by_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a node from a model by the node_id generated from extract_node_id</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>node_id</strong> – id of the node to get from the model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the retrieved node or None if no node found</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_node_input_nodes">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_node_input_nodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_node_input_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_node_input_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all of the nodes that share an output edge for the inputs to a given node</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model the node is from</p></li>
<li><p><strong>node</strong> – the node to get all input nodes for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of nodes that share an output edge
for the inputs to the given node</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_node_inputs">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_node_inputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>str<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_node_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_node_inputs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model the node is from</p></li>
<li><p><strong>node</strong> – the node to get all inputs (non initializers) for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the names of all the inputs to the node that are not initializers</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_node_output_nodes">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_node_output_nodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_node_output_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_node_output_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all of the nodes that share an input edge for the outputs from a given node</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model the node is from</p></li>
<li><p><strong>node</strong> – the node to get all output nodes for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the list of nodes that share an input edge
for the outputs from the given node</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_node_outputs">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_node_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>str<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_node_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_node_outputs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model the node is from</p></li>
<li><p><strong>node</strong> – the node to get all outputs (non initializers) for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the names of all the outputs to the node that are not initializers</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_node_params">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_node_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em>, <em class="sig-param"><span class="n">include_values</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeParam" title="sparseml.onnx.utils.helpers.NodeParam">sparseml.onnx.utils.helpers.NodeParam</a><span class="p">, </span>Optional<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeParam" title="sparseml.onnx.utils.helpers.NodeParam">sparseml.onnx.utils.helpers.NodeParam</a><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_node_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_node_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the params (weight and bias) for a node in an onnx ModelProto.
Must be an op type of one of [conv, gemm, matmul]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>node</strong> – the conv node to get the params for</p></li>
<li><p><strong>include_values</strong> – True to include the param values as numpy arrays
in the returned NodeParam objects.
False to not load the values – in this event NodeParam.val will be None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the weight, bias (if it is present)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_nodes_by_input_id">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_nodes_by_input_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">input_id</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_nodes_by_input_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_nodes_by_input_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the nodes in a model that have a given id as one of the inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>input_id</strong> – id of the input to get nodes by</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the retrieved nodes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_nodes_by_output_id">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_nodes_by_output_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">output_id</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_nodes_by_output_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_nodes_by_output_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the nodes in a model that have a given id as one of the outputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>output_id</strong> – id of the output to get nodes by</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the retrieved nodes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_numpy_dtype">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_numpy_dtype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.TensorProto</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>None<span class="p">, </span>numpy.dtype<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_numpy_dtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_numpy_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the numpy dtype of an ONNX tensor.
Returns None if there is not a direct mapping from the ONNX data type
to a numpy dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor</strong> – the tensor to get the dtype of</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy dtype for the tensor if available otherwise None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_prunable_node_from_foldable">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_prunable_node_from_foldable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">foldable_node</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">traverse_previous</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">max_node_distance</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">3</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>None<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_prunable_node_from_foldable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_prunable_node_from_foldable" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a prunable node that is attached by foldable nodes to a given foldable node.
Returns None if nothing could be found.
Ex: get the convolution that would be folded for an attached BatchNormalization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model the node is from</p></li>
<li><p><strong>foldable_node</strong> – the foldable node or node id to find prunable node from</p></li>
<li><p><strong>traverse_previous</strong> – True to only search for previous prunable nodes that the
foldable node could have been attached to for Conv -&gt; BN patterns.
False to only search for following prunable nodes that the foldable node
could have been attached to for BN -&gt; Conv patterns.</p></li>
<li><p><strong>max_node_distance</strong> – The maximum distance
(and therefore number of foldable nodes) the prunable node must be within
to match. Ex: max_node_distance = 3, the prunable node must be within 3
other foldable nodes of the foldable node passed in to match</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the found prunable node</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_prunable_nodes">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_prunable_nodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>Any<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_prunable_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_prunable_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the prunable nodes in an onnx model proto.
Prunable nodes are defined as any conv, gemm, or matmul</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – the model proto loaded from the onnx file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of nodes from the model proto</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.get_quantize_parent_for_dequantize_node">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">get_quantize_parent_for_dequantize_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantized_model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">dequantize_node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#get_quantize_parent_for_dequantize_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.get_quantize_parent_for_dequantize_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the first quantize node found by traversing the first node input of the
given de-quantize node’s ancestors. All inputs to de-quantize nodes should have
a quantize node ancestor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantized_model</strong> – the model the de-quantize node is from</p></li>
<li><p><strong>dequantize_node</strong> – the node to get an associated quantize node for</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the first quantize node found by traversing the first node input of the
given de-quantize node’s ancestors. If no quantize node is found, returns None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.is_foldable_node">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">is_foldable_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#is_foldable_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.is_foldable_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Foldable nodes as defined by ONNXRuntime and what it supports layerwise folding
in the ONNX graphs. More info can be fined in their docs:
<a class="reference external" href="https://github.com/microsoft/onnxruntime/blob/master/docs/ONNX_Runtime_Graph_Optimizations.md">https://github.com/microsoft/onnxruntime/blob/master/docs/ONNX_Runtime_Graph_Optimizations.md</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node</strong> – the node or node type to check if it is foldable or not
according to the ONNXRuntime specs</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the node is foldable and therefore can be combined with other
nodes, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.is_prunable_node">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">is_prunable_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#is_prunable_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.is_prunable_node" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model the node is from</p></li>
<li><p><strong>node</strong> – an onnx node or op_type string</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the given node is prunable, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.matmul_node_params">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">matmul_node_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">node</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.NodeProto</span></em>, <em class="sig-param"><span class="n">include_values</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeParam" title="sparseml.onnx.utils.helpers.NodeParam">sparseml.onnx.utils.helpers.NodeParam</a><span class="p">, </span>Optional<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.NodeParam" title="sparseml.onnx.utils.helpers.NodeParam">sparseml.onnx.utils.helpers.NodeParam</a><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#matmul_node_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.matmul_node_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the params (weight) for a matmul node in an onnx ModelProto.
In the future will retrieve a following bias addition as the bias for the matmul.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the model proto loaded from the onnx file</p></li>
<li><p><strong>node</strong> – the conv node to get the params for</p></li>
<li><p><strong>include_values</strong> – True to include the param values as numpy arrays
in the returned NodeParam objects.
False to not load the values – in this event NodeParam.val will be None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the weight, bias (if it is present)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.model_inputs">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">model_inputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; List<a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#model_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.model_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the input to the model from an ONNX model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – the loaded model or a file path to the onnx model
to get the model inputs for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the input to the model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.model_outputs">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">model_outputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; List<a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#model_outputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.model_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the output from an ONNX model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – the loaded model or a file path to the onnx model
to get the model outputs for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the output from the model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.onnx_nodes_sparsities">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">onnx_nodes_sparsities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span><a class="reference internal" href="#sparseml.onnx.utils.helpers.SparsityMeasurement" title="sparseml.onnx.utils.helpers.SparsityMeasurement">sparseml.onnx.utils.helpers.SparsityMeasurement</a><span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span><a class="reference internal" href="#sparseml.onnx.utils.helpers.SparsityMeasurement" title="sparseml.onnx.utils.helpers.SparsityMeasurement">sparseml.onnx.utils.helpers.SparsityMeasurement</a><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#onnx_nodes_sparsities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.onnx_nodes_sparsities" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the sparsities for each Conv or Gemm op in an onnx graph
for the associated weight inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – onnx model to use</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the overall sparsity measurement for the model,
each conv or gemm node found in the model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.helpers.validate_onnx_file">
<code class="sig-prename descclassname">sparseml.onnx.utils.helpers.</code><code class="sig-name descname">validate_onnx_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/helpers.html#validate_onnx_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.helpers.validate_onnx_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate that a file at a given path is a valid onnx model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> – the path of the file to validate</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if not a valid ONNX model</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-sparseml.onnx.utils.loss">
<span id="sparseml-onnx-utils-loss-module"></span><h2>sparseml.onnx.utils.loss module<a class="headerlink" href="#module-sparseml.onnx.utils.loss" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="sparseml.onnx.utils.loss.kl_divergence">
<code class="sig-prename descclassname">sparseml.onnx.utils.loss.</code><code class="sig-name descname">kl_divergence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">predicted</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">expected</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">zero_point</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">min_value</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="../_modules/sparseml/onnx/utils/loss.html#kl_divergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.loss.kl_divergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the kl_divergence (entropy) between two input arrays.</p>
<p>Shifts all values such that the zero_point is at one.
If a value is lower, then sets it equal to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predicted</strong> – the first array to compare with</p></li>
<li><p><strong>expected</strong> – the second array to compare with</p></li>
<li><p><strong>zero_point</strong> – the zero point that should be used to shift values above 1</p></li>
<li><p><strong>min_value</strong> – the minimum value that all values will be truncated to
if they are below</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated KL divergence</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-sparseml.onnx.utils.model">
<span id="sparseml-onnx-utils-model-module"></span><h2>sparseml.onnx.utils.model module<a class="headerlink" href="#module-sparseml.onnx.utils.model" title="Permalink to this headline">¶</a></h2>
<p>Utilities for ONNX models and running inference with them</p>
<dl class="py class">
<dt id="sparseml.onnx.utils.model.DeepSparseAnalyzeModelRunner">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.model.</code><code class="sig-name descname">DeepSparseAnalyzeModelRunner</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_cores</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#DeepSparseAnalyzeModelRunner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.DeepSparseAnalyzeModelRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sparseml.onnx.utils.model._DeepSparseBaseModelRunner</span></code></p>
<p>Class for handling running inference for an ONNX model through Neural Magic’s
analyze_model api</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the path to the ONNX model file or the loaded onnx.ModelProto</p></li>
<li><p><strong>batch_size</strong> – the size of the batch to create the model for</p></li>
<li><p><strong>num_cores</strong> – the number of physical cores to run the model on. Defaults
to run on all available cores</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="sparseml.onnx.utils.model.DeepSparseAnalyzeModelRunner.batch_forward">
<code class="sig-name descname">batch_forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">num_iterations</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">num_warmup_iterations</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">optimization_level</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">imposed_ks</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>None<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>float<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#DeepSparseAnalyzeModelRunner.batch_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.DeepSparseAnalyzeModelRunner.batch_forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – the batch to run through the ONNX model for inference
benchmarking analysis in the neural magic system</p></li>
<li><p><strong>num_iterations</strong> – number of iterations to run the analysis benchmark for</p></li>
<li><p><strong>num_warmup_iterations</strong> – number of iterations to run warmup for
before benchmarking</p></li>
<li><p><strong>optimization_level</strong> – the optimization level to use in neural magic;
1 for optimizations on, 0 for limited optimizations</p></li>
<li><p><strong>imposed_ks</strong> – kernel sparsity value to impose on all the prunable
layers in the model. None or no imposed sparsity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the result of the inference,
the time to perform the inference</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.model.DeepSparseAnalyzeModelRunner.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_loader</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#sparseml.onnx.utils.data.DataLoader" title="sparseml.onnx.utils.data.DataLoader">sparseml.onnx.utils.data.DataLoader</a></span></em>, <em class="sig-param"><span class="n">desc</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">max_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">num_iterations</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">20</span></em>, <em class="sig-param"><span class="n">num_warmup_iterations</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">optimization_level</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">imposed_ks</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>None<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>List<span class="p">[</span>Dict<span class="p">]</span><span class="p">, </span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#DeepSparseAnalyzeModelRunner.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.DeepSparseAnalyzeModelRunner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference for a model for the data given in the data_loader iterator
through neural magic inference engine model analysis function.
The analysis function allows more granular control over how the
model is executed such as optimization levels and imposing kernel sparsity.
In addition, gives back layer by layer timings that were run through.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_loader</strong> – the data_loader used to load batches of data to
run through the model</p></li>
<li><p><strong>desc</strong> – str to display if show_progress is True</p></li>
<li><p><strong>show_progress</strong> – True to show a tqdm bar when running, False otherwise</p></li>
<li><p><strong>max_steps</strong> – maximum number of steps to take for the data_loader
instead of running over all the data</p></li>
<li><p><strong>num_iterations</strong> – number of iterations to run the analysis benchmark for</p></li>
<li><p><strong>num_warmup_iterations</strong> – number of iterations to run warmup for
before benchmarking</p></li>
<li><p><strong>optimization_level</strong> – the optimization level to use in neural magic;
1 for optimizations on, 0 for limited optimizations</p></li>
<li><p><strong>imposed_ks</strong> – kernel sparsity value to impose on all the prunable
layers in the model. None or no imposed sparsity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the performance results for the run as returned
from the analyze_model function, total time to run them</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sparseml.onnx.utils.model.DeepSparseModelRunner">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.model.</code><code class="sig-name descname">DeepSparseModelRunner</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_cores</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loss</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Callable<span class="p">[</span><span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">, </span>Any<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#DeepSparseModelRunner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.DeepSparseModelRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sparseml.onnx.utils.model._DeepSparseBaseModelRunner</span></code></p>
<p>Class for handling running inference for an ONNX model through Neural Magic</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the path to the ONNX model file or the loaded onnx.ModelProto</p></li>
<li><p><strong>batch_size</strong> – the size of the batch to create the model for</p></li>
<li><p><strong>num_cores</strong> – the number of physical cores to run the model on. Defaults
to run on all available cores</p></li>
<li><p><strong>loss</strong> – the loss function, if any, to run for evaluation of the model</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="sparseml.onnx.utils.model.DeepSparseModelRunner.batch_forward">
<code class="sig-name descname">batch_forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>float<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#DeepSparseModelRunner.batch_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.DeepSparseModelRunner.batch_forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch</strong> – the batch to run through the ONNX model for inference
in the DeepSparse Engine</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the result of the inference,
the time to perform the inference</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.model.DeepSparseModelRunner.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_loader</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#sparseml.onnx.utils.data.DataLoader" title="sparseml.onnx.utils.data.DataLoader">sparseml.onnx.utils.data.DataLoader</a></span></em>, <em class="sig-param"><span class="n">desc</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">max_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>List<span class="p">[</span>Any<span class="p">]</span><span class="p">, </span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#DeepSparseModelRunner.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.DeepSparseModelRunner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference for a model for the data given in the data_loader iterator
through neural magic inference engine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_loader</strong> – the data_loader used to load batches of data to
run through the model</p></li>
<li><p><strong>desc</strong> – str to display if show_progress is True</p></li>
<li><p><strong>show_progress</strong> – True to show a tqdm bar when running, False otherwise</p></li>
<li><p><strong>max_steps</strong> – maximum number of steps to take for the data_loader
instead of running over all the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the list of outputs and the list of times
for running the data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sparseml.onnx.utils.model.ModelRunner">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.model.</code><code class="sig-name descname">ModelRunner</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">loss</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Callable<span class="p">[</span><span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">, </span>Any<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#ModelRunner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.ModelRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Abstract class for handling running inference for a model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>loss</strong> – the loss function, if any, to run for evaluation of the model</p>
</dd>
</dl>
<dl class="py method">
<dt id="sparseml.onnx.utils.model.ModelRunner.batch_forward">
<em class="property">abstract </em><code class="sig-name descname">batch_forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>Any<span class="p">, </span>float<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#ModelRunner.batch_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.ModelRunner.batch_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract method for subclasses to override to run a batch through the
inference engine for the ONNX model it was constructed with</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch</strong> – the batch to run through the ONNX model for inference</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the result of the inference,
the time to perform the inference</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.model.ModelRunner.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_loader</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#sparseml.onnx.utils.data.DataLoader" title="sparseml.onnx.utils.data.DataLoader">sparseml.onnx.utils.data.DataLoader</a></span></em>, <em class="sig-param"><span class="n">desc</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">max_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>List<span class="p">[</span>Any<span class="p">]</span><span class="p">, </span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#ModelRunner.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.ModelRunner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference for a model for the data given in the data_loader iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_loader</strong> – the data_loader used to load batches of data to
run through the model</p></li>
<li><p><strong>desc</strong> – str to display if show_progress is True</p></li>
<li><p><strong>show_progress</strong> – True to show a tqdm bar when running, False otherwise</p></li>
<li><p><strong>max_steps</strong> – maximum number of steps to take for the data_loader
instead of running over all the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the list of outputs and the list of times
for running the data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.model.ModelRunner.run_iter">
<code class="sig-name descname">run_iter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_loader</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#sparseml.onnx.utils.data.DataLoader" title="sparseml.onnx.utils.data.DataLoader">sparseml.onnx.utils.data.DataLoader</a></span></em>, <em class="sig-param"><span class="n">desc</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">max_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#ModelRunner.run_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.ModelRunner.run_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively runs inference for a model for the data given in the
data_loader iterator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_loader</strong> – the data_loader used to load batches of data to
run through the model</p></li>
<li><p><strong>desc</strong> – str to display if show_progress is True</p></li>
<li><p><strong>show_progress</strong> – True to show a tqdm bar when running, False otherwise</p></li>
<li><p><strong>max_steps</strong> – maximum number of steps to take for the data_loader
instead of running over all the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an iterator to go through the tuples containing
the list of outputs and the list of times for running the data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sparseml.onnx.utils.model.ORTModelRunner">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.model.</code><code class="sig-name descname">ORTModelRunner</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">loss</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Callable<span class="p">[</span><span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">, </span>Any<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">overwrite_input_names</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">nthreads</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">providers</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#ORTModelRunner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.ORTModelRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sparseml.onnx.utils.model.ModelRunner" title="sparseml.onnx.utils.model.ModelRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">sparseml.onnx.utils.model.ModelRunner</span></code></a></p>
<p>Class for handling running inference for an ONNX model through onnxruntime</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – the path to the ONNX model file or the loaded onnx.ModelProto</p></li>
<li><p><strong>loss</strong> – the loss function, if any, to run for evaluation of the model</p></li>
<li><p><strong>overwrite_input_names</strong> – True to overwrite the input data names to what
is found in for the model inputs, False to keep as found in the loaded data</p></li>
<li><p><strong>nthreads</strong> – number of threads used to run the model (single node);
default to 0 for onnxruntime to choose</p></li>
<li><p><strong>batch_size</strong> – if provided, and the model has a hardcoded batch size, will
rewrite the model proto so that the model batch size matches batch_size</p></li>
<li><p><strong>providers</strong> – list of ORT provider names. will default to
ort.get_available_providers()</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="sparseml.onnx.utils.model.ORTModelRunner.batch_forward">
<code class="sig-name descname">batch_forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>float<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#ORTModelRunner.batch_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.ORTModelRunner.batch_forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch</strong> – the batch to run through the ONNX model for inference
iin onnxruntime</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the result of the inference,
the time to perform the inference</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.model.ORTModelRunner.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_loader</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#sparseml.onnx.utils.data.DataLoader" title="sparseml.onnx.utils.data.DataLoader">sparseml.onnx.utils.data.DataLoader</a></span></em>, <em class="sig-param"><span class="n">desc</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_progress</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">max_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>List<span class="p">[</span>Any<span class="p">]</span><span class="p">, </span>List<span class="p">[</span>float<span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#ORTModelRunner.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.ORTModelRunner.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference for a model for the data given in the data_loader iterator
through ONNX Runtime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_loader</strong> – the data_loader used to load batches of data to
run through the model</p></li>
<li><p><strong>desc</strong> – str to display if show_progress is True</p></li>
<li><p><strong>show_progress</strong> – True to show a tqdm bar when running, False otherwise</p></li>
<li><p><strong>max_steps</strong> – maximum number of steps to take for the data_loader
instead of running over all the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple containing the list of outputs and the list of times
for running the data</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sparseml.onnx.utils.model.OpenVINOModelRunner">
<em class="property">class </em><code class="sig-prename descclassname">sparseml.onnx.utils.model.</code><code class="sig-name descname">OpenVINOModelRunner</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">loss</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Callable<span class="p">[</span><span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">, </span>Any<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nthreads</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">shape</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#OpenVINOModelRunner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.OpenVINOModelRunner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sparseml.onnx.utils.model.ModelRunner" title="sparseml.onnx.utils.model.ModelRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">sparseml.onnx.utils.model.ModelRunner</span></code></a></p>
<p>OpenVINO model runner class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The path to the IR xml file after conversion</p></li>
<li><p><strong>loss</strong> – loss function to run evaluation</p></li>
<li><p><strong>nthreads</strong> – number of threads to run the model</p></li>
<li><p><strong>batch_size</strong> – Batch size value. If not specified, the batch size value is
determined from Intermediate Representation</p></li>
<li><p><strong>shape</strong> – shape to be set for the input(s).
For example, “input1[1,3,224,224],input2[1,4]”
or “[1,3,224,224]” in case of one input size.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="sparseml.onnx.utils.model.OpenVINOModelRunner.available">
<em class="property">static </em><code class="sig-name descname">available</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#OpenVINOModelRunner.available"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.OpenVINOModelRunner.available" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.model.OpenVINOModelRunner.batch_forward">
<code class="sig-name descname">batch_forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>Any<span class="p">, </span>float<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#OpenVINOModelRunner.batch_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.OpenVINOModelRunner.batch_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a batch through the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch</strong> – batch of data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result of the inference as dictionary, and the inference time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sparseml.onnx.utils.model.OpenVINOModelRunner.network_input_shapes">
<code class="sig-name descname">network_input_shapes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#OpenVINOModelRunner.network_input_shapes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.OpenVINOModelRunner.network_input_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get network input shapes
:return: dictionary of shapes for each input key</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.model.correct_nm_analyze_model_node_ids">
<code class="sig-prename descclassname">sparseml.onnx.utils.model.</code><code class="sig-name descname">correct_nm_analyze_model_node_ids</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nm_result</span><span class="p">:</span> <span class="n">Dict</span></em>, <em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#correct_nm_analyze_model_node_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.correct_nm_analyze_model_node_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct the node ids returned from the deepsparse.analyze_model api.
In some cases, it will return the ids for folded nodes due to ONNXRuntime folding.
This finds the corrected node ids from those folded nodes.
Additionally, ops that did not have an id are changed from the returned
string &lt;none&gt; to proper None python type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nm_result</strong> – the result from the deepsparse.analyze_model api</p></li>
<li><p><strong>model</strong> – the onnx model proto or path to the onnx file that the
nm_result was for</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.model.max_available_cores">
<code class="sig-prename descclassname">sparseml.onnx.utils.model.</code><code class="sig-name descname">max_available_cores</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#max_available_cores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.max_available_cores" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the maximum number of physical cores detected on the system</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.model.split_canonical_names">
<code class="sig-prename descclassname">sparseml.onnx.utils.model.</code><code class="sig-name descname">split_canonical_names</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nm_result</span><span class="p">:</span> <span class="n">Dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/model.html#split_canonical_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.model.split_canonical_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits analysis layer results from grouped canonical names by individual nodes.
Stores the original grouped canonical name in the ‘meta_canonical_name’ field.</p>
<p>Will split on any canonical_name that includes ‘,’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nm_result</strong> – the result from the deepsparse.analyze_model api</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-sparseml.onnx.utils.sparse_tensor">
<span id="sparseml-onnx-utils-sparse-tensor-module"></span><h2>sparseml.onnx.utils.sparse_tensor module<a class="headerlink" href="#module-sparseml.onnx.utils.sparse_tensor" title="Permalink to this headline">¶</a></h2>
<p>Helper functions for handling ONNX SparseTensorProto objects.
onnx &gt;= 1.6.0 is a requirement for using sparse tensors</p>
<dl class="py function">
<dt id="sparseml.onnx.utils.sparse_tensor.convert_model_initializers_to_sparse">
<code class="sig-prename descclassname">sparseml.onnx.utils.sparse_tensor.</code><code class="sig-name descname">convert_model_initializers_to_sparse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">sparsity_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.6</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<a class="reference internal" href="../_modules/sparseml/onnx/utils/sparse_tensor.html#convert_model_initializers_to_sparse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.sparse_tensor.convert_model_initializers_to_sparse" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – ONNX model with initializers to convert to sparse</p></li>
<li><p><strong>sparsity_threshold</strong> – the minimum sparsity of a tensor to be converted
to sparse representation. Default is 0.6</p></li>
<li><p><strong>inplace</strong> – True to do model conversion in place. Default is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the given model with initializers above the sparsity threshold
converted to sparse initializers</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.sparse_tensor.convert_sparse_initializers_to_dense">
<code class="sig-prename descclassname">sparseml.onnx.utils.sparse_tensor.</code><code class="sig-name descname">convert_sparse_initializers_to_dense</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; onnx.onnx_ONNX_REL_1_6_ml_pb2.ModelProto<a class="reference internal" href="../_modules/sparseml/onnx/utils/sparse_tensor.html#convert_sparse_initializers_to_dense"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.sparse_tensor.convert_sparse_initializers_to_dense" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – ONNX model with sparse initializers to convert to dense representation</p></li>
<li><p><strong>inplace</strong> – True to do model conversion in place. Default is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The given model with all sparse initializers converted to dense
initializers</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.sparse_tensor.create_sparse_tensor">
<code class="sig-prename descclassname">sparseml.onnx.utils.sparse_tensor.</code><code class="sig-name descname">create_sparse_tensor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>onnx.onnx_ONNX_REL_1_6_ml_pb2.TensorProto<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>onnx.onnx_ONNX_REL_1_6_ml_pb2.SparseTensorProto<span class="p">]</span><a class="reference internal" href="../_modules/sparseml/onnx/utils/sparse_tensor.html#create_sparse_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.sparse_tensor.create_sparse_tensor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – numpy array or TensorProto object to convert to sparse representation</p></li>
<li><p><strong>name</strong> – name of this sparse tensor. Will be stored in
SparseTensorProto.values.name. If the given array is a TensorProto, name will
default to TensorProto.name</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SparseTensorProto object built from the sparse representation of the input
array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sparseml.onnx.utils.sparse_tensor.sparse_tensor_to_dense">
<code class="sig-prename descclassname">sparseml.onnx.utils.sparse_tensor.</code><code class="sig-name descname">sparse_tensor_to_dense</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sparse_tensor</span><span class="p">:</span> <span class="n">onnx.onnx_ONNX_REL_1_6_ml_pb2.SparseTensorProto</span></em><span class="sig-paren">)</span> &#x2192; onnx.onnx_ONNX_REL_1_6_ml_pb2.TensorProto<a class="reference internal" href="../_modules/sparseml/onnx/utils/sparse_tensor.html#sparse_tensor_to_dense"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sparseml.onnx.utils.sparse_tensor.sparse_tensor_to_dense" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sparse_tensor</strong> – SparseTensorProto object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TensorProto object that is the dense representation of the given
sparse tensor.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-sparseml.onnx.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-sparseml.onnx.utils" title="Permalink to this headline">¶</a></h2>
<p>Generic code used as utilities and helpers for ONNX</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="sparseml.optim.html" class="btn btn-neutral float-right" title="sparseml.optim package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="sparseml.onnx.optim.quantization.html" class="btn btn-neutral float-left" title="sparseml.onnx.optim.quantization package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021 - present / Neuralmagic, Inc. All Rights Reserved. Licensed under the Apache License, Version 2.0 (the &#34;License&#34;).

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-128364174-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>